#include <unistd.h>
#include "iic/mmp_iic.h"
#include "capture_module/hm1375.h"
#include "capture_module.h" 

//=============================================================================
//                Constant Definition
//============================================================================= 
#define SENSOR_ID 		 0x1375

//#define AE_WND_3_4
#define AE_WND_1_2
//#define AE_WND_FULL

//=============================================================================
//                Macro Definition
//=============================================================================

//=============================================================================
//                Structure Definition
//=============================================================================
typedef struct _REGPAIR
{
    uint16_t  addr;
    uint16_t value;
} REGPAIR;

typedef struct HM1375CaptureModuleDriverStruct
{
    CaptureModuleDriverStruct base;
} HM1375CaptureModuleDriverStruct;

//=============================================================================
//                Global Data Definition
//=============================================================================
static uint8_t  HM1375_IICADDR   = 0x48 >> 1; 
static MMP_BOOL gHM1375InitDone  = MMP_FALSE;

static REGPAIR  RESOLUTION_640x480_REG[]      =
{
    ///HM1375 initial    
    {0x0022 ,0x00},
    {0x000C ,0x04},
    {0x0006 ,0x0C},
    {0x000A ,0x20},
    {0x000F ,0x10},
    {0x0012 ,0x01},
    {0x0013 ,0x02},
    {0x0015 ,0x01},
    {0x0016 ,0x00},
    {0x0018 ,0x00},
    {0x001D ,0x40},
    {0x0020 ,0x10},
    {0x0023 ,0x43},
    {0x0024 ,0x20},
    {0x0025 ,0x00},
    {0x0026 ,0x6F},
    {0x0027 ,0x30},
    {0x0028 ,0x01},
    {0x002E ,0x0E},
    {0x0030 ,0x00},
    {0x0034 ,0x0E},
    {0x0035 ,0x01},
    {0x0036 ,0x00},
    {0x0038 ,0x02},
    {0x0039 ,0x01},
    {0x003A ,0x01},
    {0x003B ,0xFF},
    {0x003C ,0xFF},
    {0x003D ,0x40},
    {0x003F ,0x14},
    {0x0040 ,0x10},
    {0x0044 ,0x07},
    {0x0045 ,0x25},
    {0x0048 ,0x7F},
    {0x004E ,0xFF},
    {0x0070 ,0x00},
    {0x0071 ,0x4F},
    {0x0072 ,0x00},
    {0x0073 ,0x30},
    {0x0074 ,0x13},
    {0x0075 ,0x40},
    {0x0076 ,0x24},
    {0x0078 ,0x0F},
    {0x007A ,0x05},
    {0x007B ,0xF2},
    {0x007C ,0x10},
    {0x0080 ,0xC9},
    {0x0081 ,0x00},
    {0x0082 ,0x28},
    {0x0083 ,0xB0},
    {0x0084 ,0x70},
    {0x0086 ,0x3E},
    {0x0087 ,0x70},
    {0x0088 ,0x11},
    {0x0089 ,0x3C},
    {0x008A ,0x87},
    {0x008D ,0x64},
    {0x0090 ,0x07},
    {0x0091 ,0x09},
    {0x0092 ,0x0C},
    {0x0093 ,0x0C},
    {0x0094 ,0x0C},
    {0x0095 ,0x0C},
    {0x0096 ,0x01},
    {0x0097 ,0x00},
    {0x0098 ,0x04},
    {0x0099 ,0x08},
    {0x009A ,0x0C},
    {0x0120 ,0x37},
    {0x0121 ,0x81},
    {0x0122 ,0xEB},
    {0x0123 ,0x29},
    {0x0124 ,0x50},
    {0x0125 ,0xDE},
    {0x0126 ,0xB1},
    {0x013D ,0x0F},
    {0x013E ,0x0F},
    {0x013F ,0x0F},
    {0x0140 ,0x14},
    {0x0141 ,0x0A},
    {0x0142 ,0x14},
    {0x0143 ,0x0A},
    {0x0144 ,0x08},
    {0x0145 ,0x04},
    {0x0146 ,0x28},
    {0x0147 ,0x3C},
    {0x0148 ,0x28},
    {0x0149 ,0x3C},
    {0x014A ,0x96},
    {0x014B ,0xC8},
    {0x0150 ,0x14},
    {0x0151 ,0x30},
    {0x0152 ,0x54},
    {0x0153 ,0x70},
    {0x0154 ,0x14},
    {0x0155 ,0x30},
    {0x0156 ,0x54},
    {0x0157 ,0x70},
    {0x0158 ,0x14},
    {0x0159 ,0x30},
    {0x015A ,0x54},
    {0x015B ,0x70},
    {0x015C ,0x30},
    {0x015D ,0x00},
    {0x01D8 ,0x20},
    {0x01D9 ,0x08},
    {0x01DA ,0x20},
    {0x01DB ,0x08},
    {0x01DC ,0x20},
    {0x01DD ,0x08},
    {0x01DE ,0x20},
    {0x01DF ,0x08},
    {0x01E0 ,0x20},
    {0x01E1 ,0x08},
    {0x01E2 ,0xFF},
    {0x01E3 ,0x00},
    {0x01E4 ,0x10},
    {0x01E5 ,0x10},
    {0x01E6 ,0x02},
    {0x01E7 ,0x10},
    {0x01E8 ,0x10},
    {0x01E9 ,0x10},
    {0x01EA ,0x10},
    {0x01EC ,0xFA},
    {0x01EB ,0x10},
    {0x0220 ,0x00},
    {0x0221 ,0xA0},
    {0x0222 ,0x00},
    {0x0223 ,0x80},
    {0x0224 ,0x80},
    {0x0225 ,0x00},
    {0x0226 ,0x80},
    {0x0227 ,0x80},
    {0x0228 ,0x00},
    {0x0229 ,0x80},
    {0x022A ,0x80},
    {0x022B ,0x00},
    {0x022C ,0x80},
    {0x022D ,0x12},
    {0x022E ,0x10},
    {0x022F ,0x12},
    {0x0230 ,0x10},
    {0x0231 ,0x12},
    {0x0232 ,0x10},
    {0x0233 ,0x12},
    {0x0234 ,0x10},
    {0x0235 ,0x80},
    {0x0236 ,0x02},
    {0x0237 ,0x80},
    {0x0238 ,0x02},
    {0x0239 ,0x80},
    {0x023A ,0x02},
    {0x023B ,0x80},
    {0x023C ,0x02},
    {0x023D ,0x00},
    {0x023E ,0x02},
    {0x023F ,0x00},
    {0x0240 ,0x02},
    {0x0241 ,0x00},
    {0x0242 ,0x02},
    {0x0243 ,0x00},
    {0x0244 ,0x02},
    {0x0251 ,0x10},
    {0x0280 ,0x00},
    {0x0281 ,0x41},
    {0x0282 ,0x00},
    {0x0283 ,0x6D},
    {0x0284 ,0x00},
    {0x0285 ,0xBC},
    {0x0286 ,0x01},
    {0x0287 ,0x45},
    {0x0288 ,0x01},
    {0x0289 ,0x7B},
    {0x028A ,0x01},
    {0x028B ,0xAC},
    {0x028C ,0x01},
    {0x028D ,0xD2},
    {0x028E ,0x01},
    {0x028F ,0xF6},
    {0x0290 ,0x02},
    {0x0291 ,0x16},
    {0x0292 ,0x02},
    {0x0293 ,0x35},
    {0x0294 ,0x02},
    {0x0295 ,0x6E},
    {0x0296 ,0x02},
    {0x0297 ,0xA2},
    {0x0298 ,0x02},
    {0x0299 ,0xFF},
    {0x029A ,0x03},
    {0x029B ,0x51},
    {0x029C ,0x03},
    {0x029D ,0x9B},
    {0x029E ,0x00},
    {0x029F ,0x85},
    {0x02A0 ,0x04},
    {0x02C0 ,0x80},
    {0x02C1 ,0x01},
    {0x02C2 ,0x71},
    {0x02C3 ,0x04},
    {0x02C4 ,0x0F},
    {0x02C5 ,0x04},
    {0x02C6 ,0x3D},
    {0x02C7 ,0x04},
    {0x02C8 ,0x94},
    {0x02C9 ,0x01},
    {0x02CA ,0x57},
    {0x02CB ,0x04},
    {0x02CC ,0x0F},
    {0x02CD ,0x04},
    {0x02CE ,0x8F},
    {0x02CF ,0x04},
    {0x02D0 ,0x9E},
    {0x02D1 ,0x01},
    {0x02E0 ,0x06},
    {0x02E1 ,0xC0},
    {0x02E2 ,0xE0},
    {0x02F0 ,0x48},
    {0x02F1 ,0x01},
    {0x02F2 ,0x32},
    {0x02F3 ,0x04},
    {0x02F4 ,0x16},
    {0x02F5 ,0x04},
    {0x02F6 ,0x52},
    {0x02F7 ,0x04},
    {0x02F8 ,0xAA},
    {0x02F9 ,0x01},
    {0x02FA ,0x58},
    {0x02FB ,0x04},
    {0x02FC ,0x56},
    {0x02FD ,0x04},
    {0x02FE ,0xDD},
    {0x02FF ,0x04},
    {0x0300 ,0x33},
    {0x0301 ,0x02},
    {0x0324 ,0x00},
    {0x0325 ,0x01},
    {0x0333 ,0x86},
    {0x0334 ,0x00},
    {0x0335 ,0x86},
    {0x0340 ,0x40},
    {0x0341 ,0x44},
    {0x0342 ,0x4A},
    {0x0343 ,0x2B},
    {0x0344 ,0x94},
    {0x0345 ,0x3F},
    {0x0346 ,0x8E},
    {0x0347 ,0x51},
    {0x0348 ,0x75},
    {0x0349 ,0x5C},
    {0x034A ,0x6A},
    {0x034B ,0x68},
    {0x034C ,0x5E},
    {0x0350 ,0x7C},
    {0x0351 ,0x78},
    {0x0352 ,0x08},
    {0x0353 ,0x04},
    {0x0354 ,0x80},
    {0x0355 ,0x9A},
    {0x0356 ,0xCC},
    {0x0357 ,0xFF},
    {0x0358 ,0xFF},
    {0x035A ,0xFF},
    {0x035B ,0x00},
    {0x035C ,0x70},
    {0x035D ,0x80},
    {0x035F ,0xA0},
    {0x0488 ,0x30},
    {0x0360 ,0xDF},
    {0x0361 ,0x00},
    {0x0362 ,0xFF},
    {0x0363 ,0x03},
    {0x0364 ,0xFF},
    {0x037B ,0x11},
    {0x037C ,0x1E},
    {0x0380 ,0xFF},
    {0x0383 ,0x50},
    {0x038A ,0x64},
    {0x038B ,0x64},
    {0x038E ,0x3C},
    {0x0391 ,0x2A},
    {0x0393 ,0x1E},
    {0x0394 ,0x64},
    {0x0395 ,0x23},
    {0x0398 ,0x03},
    {0x0399 ,0x45},
    {0x039A ,0x06},
    {0x039B ,0x8B},
    {0x039C ,0x0D},
    {0x039D ,0x16},
    {0x039E ,0x0A},
    {0x039F ,0x10},
    {0x03A0 ,0x10},
    {0x03A1 ,0xE5},
    {0x03A2 ,0x06},
    {0x03A4 ,0x18},
    {0x03A5 ,0x48},
    {0x03A6 ,0x2D},
    {0x03A7 ,0x78},
    {0x03AC ,0x5A},
    {0x03AD ,0x0F},
    {0x03AE ,0x7F},
    {0x03AF ,0x04},
    {0x03B0 ,0x35},
    {0x03B1 ,0x14},
    {0x036F ,0x04},
    {0x0370 ,0x0A},
    {0x0371 ,0x04},
    {0x0372 ,0x10},
    {0x0373 ,0x40},
    {0x0374 ,0x20},
    {0x0375 ,0x04},
    {0x0376 ,0x00},
    {0x0377 ,0x08},
    {0x0378 ,0x08},
    {0x0379 ,0x04},
    {0x037A ,0x08},
    {0x0420 ,0x00},
    {0x0421 ,0x00},
    {0x0422 ,0x00},
    {0x0423 ,0x84},
    {0x0430 ,0x10},
    {0x0431 ,0x60},
    {0x0432 ,0x10},
    {0x0433 ,0x20},
    {0x0434 ,0x00},
    {0x0435 ,0x30},
    {0x0436 ,0x00},
    {0x0450 ,0xFD},
    {0x0451 ,0xD8},
    {0x0452 ,0xA0},
    {0x0453 ,0x50},
    {0x0454 ,0x00},
    {0x0459 ,0x04},
    {0x045A ,0x00},
    {0x045B ,0x30},
    {0x045C ,0x01},
    {0x045D ,0x70},
    {0x0460 ,0x00},
    {0x0461 ,0x00},
    {0x0462 ,0x00},
    {0x0465 ,0x16},
    {0x0466 ,0x14},
    {0x0478 ,0x00},
    {0x0480 ,0x60},
    {0x0481 ,0x06},
    {0x0482 ,0x0C},
    {0x04B0 ,0x4C},
    {0x04B1 ,0x86},
    {0x04B2 ,0x00},
    {0x04B3 ,0x18},
    {0x04B4 ,0x00},
    {0x04B5 ,0x00},
    {0x04B6 ,0x30},
    {0x04B7 ,0x00},
    {0x04B8 ,0x00},
    {0x04B9 ,0x10},
    {0x04BA ,0x00},
    {0x04BB ,0x00},
    {0x04BD ,0x00},
    {0x04D0 ,0x56},
    {0x04D6 ,0x30},
    {0x04DD ,0x10},
    {0x04D9 ,0x16},
    {0x04D3 ,0x18},
    {0x0540 ,0x01},
    {0x0541 ,0x06},
    {0x0542 ,0x01},
    {0x0543 ,0x3B},
    {0x0580 ,0x50},
    {0x0581 ,0x30},
    {0x0582 ,0x2D},
    {0x0583 ,0x16},
    {0x0584 ,0x1E},
    {0x0585 ,0x0F},
    {0x0586 ,0x08},
    {0x0587 ,0x10},
    {0x0590 ,0x10},
    {0x0591 ,0x10},
    {0x0592 ,0x05},
    {0x0593 ,0x05},
    {0x0594 ,0x04},
    {0x0595 ,0x06},
    {0x05B0 ,0x04},
    {0x05B1 ,0x00},
    {0x05E4 ,0x02},
    {0x05E5 ,0x00},
    {0x05E6 ,0x81},
    {0x05E7 ,0x02},
    {0x05E8 ,0x09},
    {0x05E9 ,0x00},
    {0x05EA ,0xE8},
    {0x05EB ,0x01},
    {0x0666 ,0x02},
    {0x0667 ,0xE0},
    {0x067F ,0x19},
    {0x067C ,0x00},
    {0x067D ,0x00},
    {0x0682 ,0x00},
    {0x0683 ,0x00},
    {0x0688 ,0x00},
    {0x0689 ,0x00},
    {0x068E ,0x00},
    {0x068F ,0x00},
    {0x0695 ,0x00},
    {0x0694 ,0x00},
    {0x0697 ,0x19},
    {0x069B ,0x00},
    {0x069C ,0x20},
    {0x0720 ,0x00},
    {0x0725 ,0x6A},
    {0x0726 ,0x03},
    {0x072B ,0x64},
    {0x072C ,0x64},
    {0x072D ,0x20},
    {0x072E ,0x82},
    {0x072F ,0x08},
    {0x0800 ,0x16},
    {0x0801 ,0x4F},
    {0x0802 ,0x00},
    {0x0803 ,0x68},
    {0x0804 ,0x01},
    {0x0805 ,0x28},
    {0x0806 ,0x10},
    {0x0808 ,0x1D},
    {0x0809 ,0x18},
    {0x080A ,0x10},
    {0x080B ,0x07},
    {0x080D ,0x0F},
    {0x080E ,0x0F},
    {0x0810 ,0x00},
    {0x0811 ,0x08},
    {0x0812 ,0x20},
    {0x0857 ,0x0A},
    {0x0858 ,0x04},
    {0x0859 ,0x01},
    {0x085A ,0x04},
    {0x085B ,0x18},
    {0x085C ,0x03},
    {0x085D ,0x7F},
    {0x085E ,0x02},
    {0x085F ,0xD0},
    {0x0860 ,0x03},
    {0x0861 ,0x7F},
    {0x0862 ,0x02},
    {0x0863 ,0xD0},
    {0x0864 ,0x02},
    {0x0865 ,0x7F},
    {0x0866 ,0x01},
    {0x0867 ,0x00},
    {0x0868 ,0x40},
    {0x0869 ,0x01},
    {0x086A ,0x00},
    {0x086B ,0x40},
    {0x086C ,0x01},
    {0x086D ,0x00},
    {0x086E ,0x40},
    {0x0870 ,0x00},
    {0x0871 ,0x14},
    {0x0872 ,0x01},
    {0x0873 ,0x20},
    {0x0874 ,0x00},
    {0x0875 ,0x14},
    {0x0876 ,0x00},
    {0x0877 ,0xEC},
    {0x0815 ,0x00},
    {0x0816 ,0x4C},
    {0x0817 ,0x00},
    {0x0818 ,0x7B},
    {0x0819 ,0x00},
    {0x081A ,0xCA},
    {0x081B ,0x01},
    {0x081C ,0x3E},
    {0x081D ,0x01},
    {0x081E ,0x77},
    {0x081F ,0x01},
    {0x0820 ,0xAA},
    {0x0821 ,0x01},
    {0x0822 ,0xCE},
    {0x0823 ,0x01},
    {0x0824 ,0xEE},
    {0x0825 ,0x02},
    {0x0826 ,0x16},
    {0x0827 ,0x02},
    {0x0828 ,0x33},
    {0x0829 ,0x02},
    {0x082A ,0x65},
    {0x082B ,0x02},
    {0x082C ,0x91},
    {0x082D ,0x02},
    {0x082E ,0xDC},
    {0x082F ,0x03},
    {0x0830 ,0x28},
    {0x0831 ,0x03},
    {0x0832 ,0x74},
    {0x0833 ,0x03},
    {0x0834 ,0xFF},
    {0x0882 ,0x00},
    {0x0883 ,0x3E},
    {0x0884 ,0x00},
    {0x0885 ,0x70},
    {0x0886 ,0x00},
    {0x0887 ,0xB8},
    {0x0888 ,0x01},
    {0x0889 ,0x28},
    {0x088A ,0x01},
    {0x088B ,0x5B},
    {0x088C ,0x01},
    {0x088D ,0x8A},
    {0x088E ,0x01},
    {0x088F ,0xB1},
    {0x0890 ,0x01},
    {0x0891 ,0xD9},
    {0x0892 ,0x01},
    {0x0893 ,0xEE},
    {0x0894 ,0x02},
    {0x0895 ,0x0F},
    {0x0896 ,0x02},
    {0x0897 ,0x4C},
    {0x0898 ,0x02},
    {0x0899 ,0x74},
    {0x089A ,0x02},
    {0x089B ,0xC3},
    {0x089C ,0x03},
    {0x089D ,0x0F},
    {0x089E ,0x03},
    {0x089F ,0x57},
    {0x08A0 ,0x03},
    {0x08A1 ,0xFF},
    {0x0100 ,0x01},
    {0x0101 ,0x01},
    {0x0000 ,0x01},
    {0x002C ,0x00},
    {0x0005 ,0x01},
};

static REGPAIR  RESOLUTION_800x600_REG[]        =
{
    {0x0022, 0x00},	// SFTSRT	_Soft Reset
    {0x000C, 0x04},	// MODE		_Reserved bit
    {0x0006, 0x08}, // Set 0x0A will do Horizontal flip
    {0x000A, 0x00}, 	// CHIPCFG	_Full frame, chip default 00
    {0x000F, 0x10},	 // IMGCFG
    {0x0012, 0x01},	// RESERVED
    {0x0013, 0x02},	// RESERVED
    {0x0015, 0x01},	// INTG_H	_Set up integration
    {0x0016, 0x00},	// INTG_L	_Set up integration
    {0x0018, 0x00},	// AGAIN		_Set up coarse gain
    {0x001D, 0x40},    // DGGAIN	_Set up fine gain
    {0x0020, 0x10},	// OPRTCFG	_AE Gain enabled, Pclk transition on falling edge
    {0x0023, 0x43},	// IOCNTR	_IO pad drive strength
    {0x0024, 0x20},	// CKCNTR	_Reserved bit
    {0x0025, 0x00},	// CKCFG		_Select PLL clock -> 24MHz to 78 MHz
    {0x0026, 0x6b}, 
    {0x0027, 0x30},	// OPORTCNTR	_YUV output, ITU601 Disable
    {0x0028, 0x01},    // CKMUL		_Reserved bit
    {0x0030, 0x00},	// EDRCFG	_Disable EDR mode
    {0x0034, 0x0E}, // EDRBLEND	_Set EDR blend to 0.875
    {0x0035, 0x01},	// RESERVED
    {0x0036, 0x00},	// RESERVED
    {0x0038, 0x02},	// EDR2AGAIN	_Set up EDR2 coarse gain
    {0x0039, 0x01}, // RESERVED
    {0x003A, 0x01},	// RESERVED
    {0x003B, 0xFF}, // RESERVED
    {0x003C, 0xFF}, // RESERVED
    {0x003D, 0x40}, // EDR2DGAIN	_Set up EDR2 fine gain
    {0x003F, 0x14}, // RESERVED      less gradient effect
    {0x0040, 0x10},	// BLCTGT	_Black level target
    {0x0044, 0x07},	// BLCCFG	_BLC configuration enable, reserved bit
    {0x0045, 0x35}, // RESERVED
    {0x0048, 0x7F}, // RESERVED
    {0x004E, 0xFF}, // RESERVED
    {0x0070, 0x22}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0071, 0x3F}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0072, 0x22}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0073, 0x30}, // RESERVED    - 0920 updated by Willie
    {0x0074, 0x13}, // RESERVED
    {0x0075, 0x40}, // RESERVED
    {0x0076, 0x24}, // RESERVED
    {0x0078, 0x0F}, // RESERVED
    {0x007A, 0x06}, // RESERVED
    {0x007B, 0x21}, // RESERVED
    {0x007C, 0x10}, // RESERVED
    {0x0080, 0xC9}, // RESERVED
    {0x0081, 0x00}, // RESERVED
    {0x0082, 0x28}, // RESERVED
    {0x0083, 0xB0}, // RESERVED
    {0x0084, 0x60}, // RESERVED
    {0x0086, 0x3E}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0087, 0x70}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0088, 0x11}, // RESERVED
    {0x0089, 0x3C}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x008A, 0x87}, // RESERVED   // Rev.E updated by Willie
    {0x008D, 0x64}, // RESERVED
    {0x0090, 0x07}, // - 12152011 updated by Willie
    {0x0091, 0x09}, // - 12152011 updated by Willie
    {0x0092, 0x0C},
    {0x0093, 0x0C},
    {0x0094, 0x0C},
    {0x0095, 0x0C},
    {0x0096, 0x01}, // AGAIN gain (nonEDR) table update for CFPN improvement 0824
    {0x0097, 0x00},
    {0x0098, 0x04},
    {0x0099, 0x08},
    {0x009A, 0x0C},
    {0x0120, 0x37}, // IPPCNTR1
    {0x0121, 0x81}, // IPPCNTR2
    {0x0122, 0xEB}, // IPPCNTR3
    {0x0123, 0x29}, // IPPCNTR4
    {0x0124, 0x50}, // CCMCNTR
    {0x0125, 0xDE}, // IPPCNTR5
    {0x0126, 0xB1}, // IPPCNTR6
    {0x013D, 0x0F},
    {0x013E, 0x0F},
    {0x013F, 0x0F},
    {0x0140, 0x14},
    {0x0141, 0x0A},
    {0x0142, 0x14},
    {0x0143, 0x0A},
    {0x0144, 0x08},	// RESERVED
    {0x0145, 0x04},	// RESERVED
    {0x0146, 0x28},	// RESERVED
    {0x0147, 0x3C},	// RESERVED  
    {0x0148, 0x28},	// RESERVED
    {0x0149, 0x3C},	// RESERVED
    {0x014A, 0x96},	// RESERVED
    {0x014B, 0xC8},	// RESERVED
    {0x0150, 0x14}, // SHPTHLR
    {0x0151, 0x30},	// SHPTHLR_A
    {0x0152, 0x54}, // SHPTHHR
    {0x0153, 0x70},	// SHPTHHR_A
    {0x0154, 0x14}, // SHPTHLG
    {0x0155, 0x30},	// SHPTHLG_A
    {0x0156, 0x54}, // SHPTHHG
    {0x0157, 0x70},	// SHPTHHG_A
    {0x0158, 0x14}, // SHPTHLB
    {0x0159, 0x30},	// SHPTHLB_A
    {0x015A, 0x54}, // SHPTHHB
    {0x015B, 0x70},	// SHPTHHB_A
    {0x015C, 0x30}, // SHPSTR    _Sharpness strength
    {0x015D, 0x00}, // SHPSTR_A  _sharpness strength_Alpha0
    {0x01D8, 0x20}, // NFHTHG
    {0x01D9, 0x08}, // NFLTHG
    {0x01DA, 0x20},	// NFHTHB
    {0x01DB, 0x08}, // NFLTHB
    {0x01DC, 0x20},	// NFHTHR
    {0x01DD, 0x08}, // NFLTHR
    {0x01DE, 0x50}, // NFHTHG_A
    {0x01E0, 0x50},	// NFHTHB_A
    {0x01E2, 0x50},	// NFHTHR_A
    {0x01E4, 0x10},	// NFSTR
    {0x01E5, 0x10},	// NFSTR_A
    {0x01E6, 0x02},	// NFSTR_OUTA
    {0x01E7, 0x10}, // NFMTHG
    {0x01E8, 0x10}, // NFMTHB
    {0x01E9, 0x10}, // NFMTHR
    {0x01EC, 0x28},	// NFMTHR_A
    {0x0220, 0x00},
    {0x0221, 0xA0},
    {0x0222, 0x00},
    {0x0223, 0x80},
    {0x0224, 0x80},
    {0x0225, 0x00},
    {0x0226, 0x80},
    {0x0227, 0x80},
    {0x0228, 0x00},
    {0x0229, 0x80},
    {0x022A, 0x80},
    {0x022B, 0x00},
    {0x022C, 0x80},
    {0x022D, 0x12},
    {0x022E, 0x10},
    {0x022F, 0x12},
    {0x0230, 0x10},
    {0x0231, 0x12},
    {0x0232, 0x10},
    {0x0233, 0x12},
    {0x0234, 0x10},
    {0x0235, 0x88},
    {0x0236, 0x02},
    {0x0237, 0x88},
    {0x0238, 0x02},
    {0x0239, 0x88},
    {0x023A, 0x02},
    {0x023B, 0x88},
    {0x023C, 0x02},
    {0x023D, 0x04},
    {0x023E, 0x02},
    {0x023F, 0x04},
    {0x0240, 0x02},
    {0x0241, 0x04},
    {0x0242, 0x02},
    {0x0243, 0x04},
    {0x0244, 0x02},
    {0x0251, 0x10},
    {0x0280, 0x00}, // normal Gamma
    {0x0281, 0x41},
    {0x0282, 0x00},
    {0x0283, 0x6D},
    {0x0284, 0x00},
    {0x0285, 0xBC},
    {0x0286, 0x01},
    {0x0287, 0x45},
    {0x0288, 0x01},
    {0x0289, 0x7B},
    {0x028A, 0x01},
    {0x028B, 0xAC},
    {0x028C, 0x01},
    {0x028D, 0xD2},
    {0x028E, 0x01},
    {0x028F, 0xF6},
    {0x0290, 0x02},
    {0x0291, 0x16},
    {0x0292, 0x02},
    {0x0293, 0x35},
    {0x0294, 0x02},
    {0x0295, 0x6E},
    {0x0296, 0x02},
    {0x0297, 0xA2},
    {0x0298, 0x02},
    {0x0299, 0xFF},
    {0x029A, 0x03},
    {0x029B, 0x51},
    {0x029C, 0x03},
    {0x029D, 0x9B}, // updated by MH 06/17
    {0x029E, 0x00}, // slope high byte
    {0x029F, 0x85}, // slope low byte
    {0x02A0, 0x04},	// GAM_A
    {0x02C0, 0x80}, //CCM00_L    _Adjust for D65 color temperature
    {0x02C1, 0x01},	//CCM00_H
    {0x02C2, 0x71},
    {0x02C3, 0x04},
    {0x02C4, 0x0F},
    {0x02C5, 0x04},
    {0x02C6, 0x3D},
    {0x02C7, 0x04},
    {0x02C8, 0x94},
    {0x02C9, 0x01},
    {0x02CA, 0x57},
    {0x02CB, 0x04},
    {0x02CC, 0x0F},
    {0x02CD, 0x04},
    {0x02CE, 0x8F},
    {0x02CF, 0x04},
    {0x02D0, 0x9E},
    {0x02D1, 0x01},
    {0x02E0, 0x06},	// CCM_A        _reduce to 0.267x
    {0x02E1, 0xC0},	// RESERVED
    {0x02E2, 0xE0},	// RESERVED
    {0x02F0, 0x48},	// ACCM00_L _Adjust for IncA color temperature
    {0x02F1, 0x01},	// ACCM00_H
    {0x02F2, 0x32},
    {0x02F3, 0x04},
    {0x02F4, 0x16},
    {0x02F5, 0x04},
    {0x02F6, 0x52},
    {0x02F7, 0x04},
    {0x02F8, 0xAA},
    {0x02F9, 0x01},
    {0x02FA, 0x58},
    {0x02FB, 0x04},
    {0x02FC, 0x56},
    {0x02FD, 0x04},
    {0x02FE, 0xDD},
    {0x02FF, 0x04},
    {0x0300, 0x33},
    {0x0301, 0x02},
    {0x0324, 0x00},
    {0x0325, 0x01},
    {0x0333, 0x86},
    {0x0334, 0x00},
    {0x0335, 0x86},
    {0x0340, 0x40},
    {0x0341, 0x44},
    {0x0342, 0x4A},
    {0x0343, 0x2B},
    {0x0344, 0x94},
    {0x0345, 0x3F},
    {0x0346, 0x8E},
    {0x0347, 0x51},
    {0x0348, 0x75},
    {0x0349, 0x5C},
    {0x034A, 0x6A},
    {0x034B, 0x68},
    {0x034C, 0x5E},
    {0x0350, 0x7C},
    {0x0351, 0x78},
    {0x0352, 0x08},
    {0x0353, 0x04},
    {0x0354, 0x80},
    {0x0355, 0x9A},
    {0x0356, 0xCC},
    {0x0357, 0xFF},
    {0x0358, 0xFF},
    {0x035A, 0xFF},
    {0x035B, 0x00},
    {0x035C, 0x70},
    {0x035D, 0x80},
    {0x035F, 0xA0},
    {0x0488, 0x30},
    {0x0360, 0xDF},
    {0x0361, 0x00},
    {0x0362, 0xFF},
    {0x0363, 0x03},
    {0x0364, 0xFF},
    {0x037B, 0x11}, //whole nonEDR to EDR ratio
    {0x037C, 0x1E}, //EDR LONG litbin pop out to nonEDR
    {0x0380, 0xFF},
    {0x0383, 0x50}, // RESERVED
    {0x038A, 0x64},
    {0x038B, 0x64},
    {0x038E, 0x3C},
    {0x0391, 0x2A}, // RESERVED
    {0x0393, 0x1E}, // RESERVED
    {0x0394, 0x64},	// RESERVED
    {0x0395, 0x23},
    {0x0398, 0x03},	// RESERVED
    {0x0399, 0x45},	// RESERVED
    {0x039A, 0x06},	// RESERVED
    {0x039B, 0x8B},	// RESERVED
    {0x039C, 0x0D},	// RESERVED
    {0x039D, 0x16},	// RESERVED
    {0x039E, 0x0A},	// RESERVED
    {0x039F, 0x10},
    {0x03A0, 0x10},
    {0x03A1, 0xE5},	// RESERVED
    {0x03A2, 0x06}, // RESERVED
    {0x03A4, 0x18},
    {0x03A5, 0x48},
    {0x03A6, 0x2D},	// RESERVED
    {0x03A7, 0x78},	// RESERVED
    {0x03AC, 0x5A},	// RESERVED
    {0x03AD, 0x0F},	// RESERVED
    {0x03AE, 0x7F},	// RESERVED
    {0x03AF, 0x04},	// RESERVED
    {0x03B0, 0x35},	// RESERVED
    {0x03B1, 0x14},	// RESERVED
    {0x036F, 0x04}, // Bayer denoise strength EDR
    {0x0370, 0x0A}, // Bayer denoise strength nonEDR
    {0x0371, 0x04}, // Bayer denoise strength EDR A0
    {0x0372, 0x00}, // Bayer denoise strength nonEDR A0
    {0x0373, 0x40}, // raw sharpness strength EDR
    {0x0374, 0x20}, // raw sharpness strength nonEDR
    {0x0375, 0x04}, // raw sharpness strength EDR A0
    {0x0376, 0x00}, // raw sharpness strength nonEDR A0
    {0x0377, 0x08}, // Y Denoise strength EDR
    {0x0378, 0x08}, // Y Denoise strength nonEDR
    {0x0379, 0x04}, // Y Denoise strength EDR A0
    {0x037A, 0x08}, // Y Denoise strength nonEDR A0
    {0x0420, 0x00},
    {0x0421, 0x00},
    {0x0422, 0x00},
    {0x0423, 0x84},
    {0x0430, 0x10},
    {0x0431, 0x60},
    {0x0432, 0x10},
    {0x0433, 0x20},
    {0x0434, 0x00},
    {0x0435, 0x30},
    {0x0436, 0x00},
    {0x0450, 0xFD},
    {0x0451, 0xD8},
    {0x0452, 0xA0},
    {0x0453, 0x50},
    {0x0454, 0x00},
    {0x0459, 0x04},
    {0x045A, 0x00},
    {0x045B, 0x30},
    {0x045C, 0x01},
    {0x045D, 0x70},
    {0x0460, 0x00},
    {0x0461, 0x00},
    {0x0462, 0x00},
    {0x0465, 0x16},
    {0x0466, 0x14},
    {0x0478, 0x00},
    {0x0480, 0x60},
    {0x0481, 0x06},
    {0x0482, 0x0C},
    {0x04B0, 0x4C},	// Contrast 05032011 by mh
    {0x04B1, 0x86},	// contrast 06/17 by mh
    {0x04B2, 0x00},	//
    {0x04B3, 0x18},	//
    {0x04B4, 0x00},	//
    {0x04B5, 0x00},	//
    {0x04B6, 0x30},	//
    {0x04B7, 0x00},	//
    {0x04B8, 0x00},	//
    {0x04B9, 0x10},	//
    {0x04BA, 0x00},	//
    {0x04BB, 0x00},	//
    {0x04BD, 0x00},	//
    {0x04D0, 0x56},
    {0x04D6, 0x30},
    {0x04DD, 0x10},
    {0x04D9, 0x16},
    {0x04D3, 0x18},
    {0x0540, 0x00},
    {0x0541, 0xD7},
    {0x0542, 0x01},
    {0x0543, 0x02},
    {0x0580, 0x50},	// RESERVED
    {0x0581, 0x30},	// RESERVED
    {0x0582, 0x2D},
    {0x0583, 0x16},
    {0x0584, 0x1E},
    {0x0585, 0x0F},
    {0x0586, 0x08},
    {0x0587, 0x10},
    {0x0590, 0x10},
    {0x0591, 0x10},
    {0x0592, 0x05},
    {0x0593, 0x05},
    {0x0594, 0x04},
    {0x0595, 0x06},
    {0x05B0, 0x04},
    {0x05B1, 0x00},
    {0x05E4, 0xF4},
	{0x05E5, 0x00},
	{0x05E6, 0x13},
	{0x05E7, 0x04},
    {0x05E8, 0x40},
    {0x05E9, 0x00},
    {0x05EA, 0x97},
    {0x05EB, 0x02},
    {0x0666, 0x02},
    {0x0667, 0xE0},
    {0x067F, 0x19},
    {0x067C, 0x00},
    {0x067D, 0x00},
    {0x0682, 0x00},
    {0x0683, 0x00},
    {0x0688, 0x00},
    {0x0689, 0x00},
    {0x068E, 0x00},
    {0x068F, 0x00},
    {0x0695, 0x00},
    {0x0694, 0x00},
    {0x0697, 0x19},
    {0x069B, 0x00},
    {0x069C, 0x30},  // max EDR ratio
    {0x0720, 0x00},
    {0x0725, 0x6A},
    {0x0726, 0x03},
    {0x072B, 0x64},
    {0x072C, 0x64},
    {0x072D, 0x20},
    {0x072E, 0x82},   //turn off night mode
    {0x072F, 0x08},
    {0x0800, 0x16},
    {0x0801, 0x30},
    {0x0802, 0x00},
    {0x0803, 0x68},
    {0x0804, 0x01},
    {0x0805, 0x28},
    {0x0806, 0x10},
    {0x0808, 0x1D},
    {0x0809, 0x18},
    {0x080A, 0x10},
    {0x080B, 0x07},
    {0x080D, 0x0F},
    {0x080E, 0x0F},
    {0x0810, 0x00},
    {0x0811, 0x08},
    {0x0812, 0x20},
    {0x0857, 0x0A},
    {0x0858, 0x30},
    {0x0859, 0x01},
    {0x085A, 0x03},	//(whole)Max INTG
    {0x085B, 0x40},
    {0x085C, 0x03},
    {0x085D, 0x7F},
    {0x085E, 0x02},	//(Long)Max INTG
    {0x085F, 0xD0},
    {0x0860, 0x03},
    {0x0861, 0x7F},
    {0x0862, 0x02},	//(short)Max INTG
    {0x0863, 0xD0},
    {0x0864, 0x00}, //(short)Max AG
    {0x0865, 0x7F},
    {0x0866, 0x01},
    {0x0867, 0x00},
    {0x0868, 0x40},
    {0x0869, 0x01},
    {0x086A, 0x00},
    {0x086B, 0x40},
    {0x086C, 0x01},
    {0x086D, 0x00},
    {0x086E, 0x40},
#if defined(AE_WND_FULL)
    {0x0870, 0x00},
    {0x0871, 0x14},
    {0x0872, 0x01},
    {0x0873, 0x20},
    {0x0874, 0x00},
    {0x0875, 0x14},
    {0x0876, 0x00},
    {0x0877, 0xEC},
#elif defined(AE_WND_3_4)
    {0x0870, 0x00},
    {0x0871, 0x36},
    {0x0872, 0x00},
    {0x0873, 0xFE},
    {0x0874, 0x00},
    {0x0875, 0x2F},
    {0x0876, 0x00},
    {0x0877, 0xD1},
#elif defined(AE_WND_1_2)
    {0x0870, 0x00},
    {0x0871, 0x58},
    {0x0872, 0x00},
    {0x0873, 0xDC},
    {0x0874, 0x00},
    {0x0875, 0x4A},
    {0x0876, 0x00},
    {0x0877, 0xB6},
#endif
    {0x0815, 0x00},
    {0x0816, 0x4C},
    {0x0817, 0x00},
    {0x0818, 0x7B},
    {0x0819, 0x00},
    {0x081A, 0xCA},
    {0x081B, 0x01},
    {0x081C, 0x3E},
    {0x081D, 0x01},
    {0x081E, 0x77},
    {0x081F, 0x01},
    {0x0820, 0xAA},
    {0x0821, 0x01},
    {0x0822, 0xCE},
    {0x0823, 0x01},
    {0x0824, 0xEE},
    {0x0825, 0x02},
    {0x0826, 0x16},
    {0x0827, 0x02},
    {0x0828, 0x33},
    {0x0829, 0x02},
    {0x082A, 0x65},
    {0x082B, 0x02},
    {0x082C, 0x91},
    {0x082D, 0x02},
    {0x082E, 0xDC},
    {0x082F, 0x03},
    {0x0830, 0x28},
    {0x0831, 0x03},
    {0x0832, 0x74},
    {0x0833, 0x03},
    {0x0834, 0xFF},
    {0x0882, 0x00},
    {0x0883, 0x3E},
    {0x0884, 0x00},
    {0x0885, 0x70},
    {0x0886, 0x00},
    {0x0887, 0xB8},
    {0x0888, 0x01},
    {0x0889, 0x28},
    {0x088A, 0x01},
    {0x088B, 0x5B},
    {0x088C, 0x01},
    {0x088D, 0x8A},
    {0x088E, 0x01},
    {0x088F, 0xB1},
    {0x0890, 0x01},
    {0x0891, 0xD9},
    {0x0892, 0x01},
    {0x0893, 0xEE},
    {0x0894, 0x02},
    {0x0895, 0x0F},
    {0x0896, 0x02},
    {0x0897, 0x4C},
    {0x0898, 0x02},
    {0x0899, 0x74},
    {0x089A, 0x02},
    {0x089B, 0xC3},
    {0x089C, 0x03},
    {0x089D, 0x0F},
    {0x089E, 0x03},
    {0x089F, 0x57},
    {0x08A0, 0x03},
    {0x08A1, 0xFF},

    {0x0023, 0x77}, //update 
	{0x008F, 0x77}, //if setting bigger , rising fast. (skew).

    {0x0100, 0x01}, // CMU AE
    {0x0101, 0x01}, // CMU AWB
    {0x0000, 0x01}, // CMU
    {0x002C, 0x00}, // Reset 8051
    {0x0005, 0x01}, // Trigger
};

static REGPAIR  RESOLUTION_1280x720p_REG[]      =
{
    {0x0022, 0x00},	// SFTSRT	_Soft Reset
    {0x000C, 0x04},	// MODE		_Reserved bit

    {0x0006, 0x08}, //720p=0x08 
	
    {0x000A, 0x00}, // CHIPCFG	_Full frame, chip default 00
    {0x000F, 0x10},	//720p = 0x10, // IMGCFG
    {0x0012, 0x01},	// RESERVED
    {0x0013, 0x02},	// RESERVED

    {0x0015, 0x01},	// INTG_H	_Set up integration
    {0x0016, 0x00},	// INTG_L	_Set up integration
    {0x0018, 0x00},	// AGAIN		_Set up coarse gain
    {0x001D, 0x40},    // DGGAIN	_Set up fine gain


    {0x0020, 0x10},	// OPRTCFG	_AE Gain enabled, Pclk transition on falling edge
    {0x0023, 0x43},	// IOCNTR	_IO pad drive strength
    {0x0024, 0x20},	// CKCNTR	_Reserved bit
    {0x0025, 0x00},	// CKCFG		_Select PLL clock -> 24MHz to 78 MHz
    {0x0026, 0x6b}, //720p = 0x6b
    {0x0027, 0x30},	// OPORTCNTR	_YUV output, ITU601 Disable
    {0x0028, 0x01},    // CKMUL		_Reserved bit

    {0x0030, 0x00},	// EDRCFG	_Disable EDR mode
    {0x0034, 0x0E}, // EDRBLEND	_Set EDR blend to 0.875
    {0x0035, 0x01},	// RESERVED
    {0x0036, 0x00},	// RESERVED
    {0x0038, 0x02},	// EDR2AGAIN	_Set up EDR2 coarse gain
    {0x0039, 0x01}, // RESERVED
    {0x003A, 0x01},	// RESERVED
    {0x003B, 0xFF}, // RESERVED
    {0x003C, 0xFF}, // RESERVED
    {0x003D, 0x40}, // EDR2DGAIN	_Set up EDR2 fine gain
    {0x003F, 0x14}, // RESERVED      less gradient effect

    //----------------------------------------------
    //BLACK LEVEL CONTROL
    //----------------------------------------------

    {0x0040, 0x10},	// BLCTGT	_Black level target
    {0x0044, 0x07},	// BLCCFG	_BLC configuration enable, reserved bit

    //----------------------------------------------
    //RESERVED REGISTERS FOR SENSOR READOUT_TIMING
    //----------------------------------------------

    {0x0045, 0x35}, // RESERVED
    {0x0048, 0x7F}, // RESERVED
    {0x004E, 0xFF}, // RESERVED
    {0x0070, 0x22}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0071, 0x3F}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0072, 0x22}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0073, 0x30}, // RESERVED    - 0920 updated by Willie
    {0x0074, 0x13}, // RESERVED
    {0x0075, 0x40}, // RESERVED
    {0x0076, 0x24}, // RESERVED
    {0x0078, 0x0F}, // RESERVED
    {0x007A, 0x06}, // RESERVED
    {0x007B, 0x21}, // RESERVED
    {0x007C, 0x10}, // RESERVED
    {0x0080, 0xC9}, // RESERVED
    {0x0081, 0x00}, // RESERVED
    {0x0082, 0x28}, // RESERVED
    {0x0083, 0xB0}, // RESERVED
    {0x0084, 0x60}, // RESERVED
    {0x0086, 0x3E}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0087, 0x70}, // RESERVED    - 1024 updated by Willie 4 S-2
    {0x0088, 0x11}, // RESERVED
    {0x0089, 0x3C}, // RESERVED    - 1024 updated by Willie 4 S-2
    //{0x008A, 0x80},        // RESERVED    // Rev.C
    {0x008A, 0x87}, // RESERVED   // Rev.E updated by Willie
    {0x008D, 0x64}, // RESERVED

    {0x0090, 0x07}, // - 12152011 updated by Willie
    {0x0091, 0x09}, // - 12152011 updated by Willie
    {0x0092, 0x0C},
    {0x0093, 0x0C},
    {0x0094, 0x0C},
    {0x0095, 0x0C},
    {0x0096, 0x01}, // AGAIN gain (nonEDR) table update for CFPN improvement 0824
    {0x0097, 0x00},
    {0x0098, 0x04},
    {0x0099, 0x08},
    {0x009A, 0x0C},


    //----------------------------------------------
    //IMAGE PIPELINE PROCESSING CONTROL
    //----------------------------------------------

    {0x0120, 0x37}, // IPPCNTR1
    {0x0121, 0x81}, // IPPCNTR2
    {0x0122, 0xEB}, // IPPCNTR3
    {0x0123, 0x29}, // IPPCNTR4
    {0x0124, 0x50}, // CCMCNTR
    {0x0125, 0xDE}, // IPPCNTR5
    {0x0126, 0xB1}, // IPPCNTR6

    //----------------------------------------------
    //FLARE CORRECTION
    //----------------------------------------------

    {0x013D, 0x0F},
    {0x013E, 0x0F},
    {0x013F, 0x0F},

    //----------------------------------------------
    //BAD PIXEL CONTROL
    //----------------------------------------------

    {0x0140, 0x14},
    {0x0141, 0x0A},
    {0x0142, 0x14},
    {0x0143, 0x0A},

    //----------------------------------------------
    //RESERVED
    //----------------------------------------------

    {0x0144, 0x08},	// RESERVED
    {0x0145, 0x04},	// RESERVED
    {0x0146, 0x28},	// RESERVED
    {0x0147, 0x3C},	// RESERVED
    {0x0148, 0x28},	// RESERVED
    {0x0149, 0x3C},	// RESERVED
    {0x014A, 0x96},	// RESERVED
    {0x014B, 0xC8},	// RESERVED

    //----------------------------------------------
    //SHARPENING CONTROL
    //----------------------------------------------

    {0x0150, 0x14}, // SHPTHLR
    {0x0151, 0x30},	// SHPTHLR_A
    {0x0152, 0x54}, // SHPTHHR
    {0x0153, 0x70},	// SHPTHHR_A
    {0x0154, 0x14}, // SHPTHLG
    {0x0155, 0x30},	// SHPTHLG_A
    {0x0156, 0x54}, // SHPTHHG
    {0x0157, 0x70},	// SHPTHHG_A
    {0x0158, 0x14}, // SHPTHLB
    {0x0159, 0x30},	// SHPTHLB_A
    {0x015A, 0x54}, // SHPTHHB
    {0x015B, 0x70},	// SHPTHHB_A
    {0x015C, 0x30}, // SHPSTR    _Sharpness strength
    {0x015D, 0x00}, // SHPSTR_A  _sharpness strength_Alpha0


    //----------------------------------------------
    // NOISEFILTER CONTROL
    //----------------------------------------------

    {0x01D8, 0x20}, // NFHTHG
    {0x01D9, 0x08}, // NFLTHG
    {0x01DA, 0x20},	// NFHTHB
    {0x01DB, 0x08}, // NFLTHB
    {0x01DC, 0x20},	// NFHTHR
    {0x01DD, 0x08}, // NFLTHR
    {0x01DE, 0x50}, // NFHTHG_A
    {0x01E0, 0x50},	// NFHTHB_A
    {0x01E2, 0x50},	// NFHTHR_A
    {0x01E4, 0x10},	// NFSTR
    {0x01E5, 0x10},	// NFSTR_A
    {0x01E6, 0x02},	// NFSTR_OUTA
    {0x01E7, 0x10}, // NFMTHG
    {0x01E8, 0x10}, // NFMTHB
    {0x01E9, 0x10}, // NFMTHR
    {0x01EC, 0x28},	// NFMTHR_A

    //----------------------------------------------
    //LENS SHADING CORRECTION
    //----------------------------------------------

    {0x0220, 0x00},
    {0x0221, 0xA0},
    {0x0222, 0x00},
    {0x0223, 0x80},
    {0x0224, 0x80},
    {0x0225, 0x00},
    {0x0226, 0x80},
    {0x0227, 0x80},
    {0x0228, 0x00},
    {0x0229, 0x80},
    {0x022A, 0x80},
    {0x022B, 0x00},
    {0x022C, 0x80},
    {0x022D, 0x12},
    {0x022E, 0x10},
    {0x022F, 0x12},
    {0x0230, 0x10},
    {0x0231, 0x12},
    {0x0232, 0x10},
    {0x0233, 0x12},
    {0x0234, 0x10},
    {0x0235, 0x88},
    {0x0236, 0x02},
    {0x0237, 0x88},
    {0x0238, 0x02},
    {0x0239, 0x88},
    {0x023A, 0x02},
    {0x023B, 0x88},
    {0x023C, 0x02},
    {0x023D, 0x04},
    {0x023E, 0x02},
    {0x023F, 0x04},
    {0x0240, 0x02},
    {0x0241, 0x04},
    {0x0242, 0x02},
    {0x0243, 0x04},
    {0x0244, 0x02},
    {0x0251, 0x10},

    //----------------------------------------------
    //GAMMA CONTROL
    //----------------------------------------------

    {0x0280, 0x00}, // normal Gamma
    {0x0281, 0x41},
    {0x0282, 0x00},
    {0x0283, 0x6D},
    {0x0284, 0x00},
    {0x0285, 0xBC},
    {0x0286, 0x01},
    {0x0287, 0x45},
    {0x0288, 0x01},
    {0x0289, 0x7B},
    {0x028A, 0x01},
    {0x028B, 0xAC},
    {0x028C, 0x01},
    {0x028D, 0xD2},
    {0x028E, 0x01},
    {0x028F, 0xF6},
    {0x0290, 0x02},
    {0x0291, 0x16},
    {0x0292, 0x02},
    {0x0293, 0x35},
    {0x0294, 0x02},
    {0x0295, 0x6E},
    {0x0296, 0x02},
    {0x0297, 0xA2},
    {0x0298, 0x02},
    {0x0299, 0xFF},
    {0x029A, 0x03},
    {0x029B, 0x51},
    {0x029C, 0x03},
    {0x029D, 0x9B}, // updated by MH 06/17
    {0x029E, 0x00}, // slope high byte
    {0x029F, 0x85}, // slope low byte


    //{0x0280, 0x00},
    //{0x0281, 0x41},
    //{0x0282, 0x00},
    //{0x0283, 0x6D},
    //{0x0284, 0x00},
    //{0x0285, 0xBC},
    //{0x0286, 0x01},
    //{0x0287, 0x45},
    //{0x0288, 0x01},
    //{0x0289, 0x7B},
    //{0x028A, 0x01},
    //{0x028B, 0xAC},
    //{0x028C, 0x01},
    //{0x028D, 0xD2},
    //{0x028E, 0x01},
    //{0x028F, 0xF6},
    //{0x0290, 0x02},
    //{0x0291, 0x16},
    //{0x0292, 0x02},
    //{0x0293, 0x35},
    //{0x0294, 0x02},
    //{0x0295, 0x6E},
    //{0x0296, 0x02},
    //{0x0297, 0xA2},
    //{0x0298, 0x02},
    //{0x0299, 0xFF},
    //{0x029A, 0x03},
    //{0x029B, 0x51},
    //{0x029C, 0x03},
    //{0x029D, 0x9B},
    //{0x029E, 0x00},
    //{0x029F, 0x85},
    {0x02A0, 0x04},	// GAM_A

    //----------------------------------------------
    //COLOR CORRECTION MATRIX
    //----------------------------------------------

    {0x02C0, 0x80}, //CCM00_L    _Adjust for D65 color temperature
    {0x02C1, 0x01},	//CCM00_H
    {0x02C2, 0x71},
    {0x02C3, 0x04},
    {0x02C4, 0x0F},
    {0x02C5, 0x04},
    {0x02C6, 0x3D},
    {0x02C7, 0x04},
    {0x02C8, 0x94},
    {0x02C9, 0x01},
    {0x02CA, 0x57},
    {0x02CB, 0x04},
    {0x02CC, 0x0F},
    {0x02CD, 0x04},
    {0x02CE, 0x8F},
    {0x02CF, 0x04},
    {0x02D0, 0x9E},
    {0x02D1, 0x01},
    {0x02E0, 0x06},	// CCM_A        _reduce to 0.267x
    {0x02E1, 0xC0},	// RESERVED
    {0x02E2, 0xE0},	// RESERVED
    {0x02F0, 0x48},	// ACCM00_L _Adjust for IncA color temperature
    {0x02F1, 0x01},	// ACCM00_H
    {0x02F2, 0x32},
    {0x02F3, 0x04},
    {0x02F4, 0x16},
    {0x02F5, 0x04},
    {0x02F6, 0x52},
    {0x02F7, 0x04},
    {0x02F8, 0xAA},
    {0x02F9, 0x01},
    {0x02FA, 0x58},
    {0x02FB, 0x04},
    {0x02FC, 0x56},
    {0x02FD, 0x04},
    {0x02FE, 0xDD},
    {0x02FF, 0x04},
    {0x0300, 0x33},
    {0x0301, 0x02},

    //----------------------------------------------
    //AUTOMATIC WHITE BALANCE WINDOW CONTROL
    //----------------------------------------------

    {0x0324, 0x00},
    {0x0325, 0x01},

    //----------------------------------------------
    //AUTOMATIC WHITE BALANCE DETECTION AND LIMITS
    //----------------------------------------------

    {0x0333, 0x86},
    {0x0334, 0x00},
    {0x0335, 0x86},

    {0x0340, 0x40},
    {0x0341, 0x44},
    {0x0342, 0x4A},
    {0x0343, 0x2B},
    {0x0344, 0x94},
    {0x0345, 0x3F},
    {0x0346, 0x8E},
    {0x0347, 0x51},
    {0x0348, 0x75},
    {0x0349, 0x5C},
    {0x034A, 0x6A},
    {0x034B, 0x68},
    {0x034C, 0x5E},
    {0x0350, 0x7C},
    {0x0351, 0x78},
    {0x0352, 0x08},
    {0x0353, 0x04},
    {0x0354, 0x80},
    {0x0355, 0x9A},
    {0x0356, 0xCC},
    {0x0357, 0xFF},
    {0x0358, 0xFF},
    {0x035A, 0xFF},
    {0x035B, 0x00},
    {0x035C, 0x70},
    {0x035D, 0x80},
    {0x035F, 0xA0},
    {0x0488, 0x30},
    {0x0360, 0xDF},
    {0x0361, 0x00},
    {0x0362, 0xFF},
    {0x0363, 0x03},
    {0x0364, 0xFF},

    {0x037B, 0x11}, //whole nonEDR to EDR ratio
    {0x037C, 0x1E}, //EDR LONG litbin pop out to nonEDR

    //----------------------------------------------
    //AUTOMATIC EXPOSURE CONFIGURATION
    //----------------------------------------------

    {0x0380, 0xFF},
    {0x0383, 0x50}, // RESERVED
    {0x038A, 0x64},
    {0x038B, 0x64},
    {0x038E, 0x3C},
    {0x0391, 0x2A}, // RESERVED
    {0x0393, 0x1E}, // RESERVED
    {0x0394, 0x64},	// RESERVED
    {0x0395, 0x23},
    {0x0398, 0x03},	// RESERVED
    {0x0399, 0x45},	// RESERVED
    {0x039A, 0x06},	// RESERVED
    {0x039B, 0x8B},	// RESERVED
    {0x039C, 0x0D},	// RESERVED
    {0x039D, 0x16},	// RESERVED
    {0x039E, 0x0A},	// RESERVED
    {0x039F, 0x10},
    {0x03A0, 0x10},
    {0x03A1, 0xE5},	// RESERVED
    {0x03A2, 0x06}, // RESERVED
    {0x03A4, 0x18},
    {0x03A5, 0x48},
    {0x03A6, 0x2D},	// RESERVED
    {0x03A7, 0x78},	// RESERVED
    {0x03AC, 0x5A},	// RESERVED
    {0x03AD, 0x0F},	// RESERVED
    {0x03AE, 0x7F},	// RESERVED
    {0x03AF, 0x04},	// RESERVED
    {0x03B0, 0x35},	// RESERVED
    {0x03B1, 0x14},	// RESERVED


    {0x036F, 0x04}, // Bayer denoise strength EDR
    {0x0370, 0x0A}, // Bayer denoise strength nonEDR
    {0x0371, 0x04}, // Bayer denoise strength EDR A0
    {0x0372, 0x00}, // Bayer denoise strength nonEDR A0

    {0x0373, 0x40}, // raw sharpness strength EDR
    {0x0374, 0x20}, // raw sharpness strength nonEDR
    {0x0375, 0x04}, // raw sharpness strength EDR A0
    {0x0376, 0x00}, // raw sharpness strength nonEDR A0

    {0x0377, 0x08}, // Y Denoise strength EDR
    {0x0378, 0x08}, // Y Denoise strength nonEDR
    {0x0379, 0x04}, // Y Denoise strength EDR A0
    {0x037A, 0x08}, // Y Denoise strength nonEDR A0

    //----------------------------------------------
    //DIGITAL BLACK LEVEL OFFSET CONTROL
    //----------------------------------------------

    {0x0420, 0x00},
    {0x0421, 0x00},
    {0x0422, 0x00},
    {0x0423, 0x84},

    //----------------------------------------------
    //AUTO BLACK LEVEL
    //----------------------------------------------

    {0x0430, 0x10},
    {0x0431, 0x60},
    {0x0432, 0x10},
    {0x0433, 0x20},
    {0x0434, 0x00},
    {0x0435, 0x30},
    {0x0436, 0x00},

    //----------------------------------------------
    //LOWLIGHT_OUTDOOR IPP CONTROL
    //----------------------------------------------

    {0x0450, 0xFD},
    {0x0451, 0xD8},
    {0x0452, 0xA0},
    {0x0453, 0x50},
    {0x0454, 0x00},
    {0x0459, 0x04},
    {0x045A, 0x00},
    {0x045B, 0x30},
    {0x045C, 0x01},
    {0x045D, 0x70},
    {0x0460, 0x00},
    {0x0461, 0x00},
    {0x0462, 0x00},
    {0x0465, 0x16},
    {0x0466, 0x14},
    {0x0478, 0x00},

    //----------------------------------------------
    //COLOR SPACE CONVERSION_SATURATION ADJ
    //----------------------------------------------

    {0x0480, 0x60},
    {0x0481, 0x06},
    {0x0482, 0x0C},

    //----------------------------------------------
    //CONTRAST_BRIGHTNESS
    //----------------------------------------------


    {0x04B0, 0x4C},	// Contrast 05032011 by mh
    {0x04B1, 0x86},	// contrast 06/17 by mh
    {0x04B2, 0x00},	//
    {0x04B3, 0x18},	//
    {0x04B4, 0x00},	//
    {0x04B5, 0x00},	//
    {0x04B6, 0x30},	//
    {0x04B7, 0x00},	//
    {0x04B8, 0x00},	//
    {0x04B9, 0x10},	//
    {0x04BA, 0x00},	//
    {0x04BB, 0x00},	//
    {0x04BD, 0x00},	//

    //{0x04B0, 0x46},       // 07202011 released
    //{0x04B1, 0x84},
    //{0x04B2, 0x00},
    //{0x04B3, 0x18},
    //{0x04B4, 0x00},
    //{0x04B5, 0x00},
    //{0x04B6, 0x30},
    //{0x04B7, 0x00},
    //{0x04B8, 0x00},
    //{0x04B9, 0x10},
    //{0x04BA, 0x00},
    //{0x04BB, 0x00},
    //{0x04BD, 0x00},

    //----------------------------------------------
    //EDR CONTRAST
    //----------------------------------------------

    {0x04D0, 0x56},
    {0x04D6, 0x30},
    {0x04DD, 0x10},
    {0x04D9, 0x16},
    {0x04D3, 0x18},

    //----------------------------------------------
    //AE FLICKER STEP SIZE
    //----------------------------------------------

    {0x0540, 0x00},
    {0x0541, 0xD7},
    {0x0542, 0x01},
    {0x0543, 0x02},
    {0x0580, 0x50},	// RESERVED
    {0x0581, 0x30},	// RESERVED

    //----------------------------------------------
    //Y_COLOR NOISE REDUCTION
    //----------------------------------------------

    {0x0582, 0x2D},
    {0x0583, 0x16},
    {0x0584, 0x1E},
    {0x0585, 0x0F},
    {0x0586, 0x08},
    {0x0587, 0x10},
    {0x0590, 0x10},
    {0x0591, 0x10},
    {0x0592, 0x05},
    {0x0593, 0x05},
    {0x0594, 0x04},
    {0x0595, 0x06},

    //----------------------------------------------
    //Y_Sharpness strength
    //----------------------------------------------

    {0x05B0, 0x04},
    {0x05B1, 0x00},


    //----------------------------------------------
    //WINDOW_SCALER
    //----------------------------------------------

    //{0x05E4, 0x02},
    //{0x05E5, 0x00},
    //{0x05E6, 0x01},
    //{0x05E7, 0x05},


    {0x05E4, 0x08},
    {0x05E5, 0x00},
    {0x05E6, 0x07},
    {0x05E7, 0x05},
    {0x05E8, 0x0A},
    {0x05E9, 0x00},
    {0x05EA, 0xD9},
    {0x05EB, 0x02},

    //----------------------------------------------
    //FLEXI ENGINE_AE ADJUST CONTROL
    //----------------------------------------------

    {0x0666, 0x02},
    {0x0667, 0xE0},
    {0x067F, 0x19},
    {0x067C, 0x00},
    {0x067D, 0x00},
    {0x0682, 0x00},
    {0x0683, 0x00},
    {0x0688, 0x00},
    {0x0689, 0x00},
    {0x068E, 0x00},
    {0x068F, 0x00},
    {0x0695, 0x00},
    {0x0694, 0x00},
    {0x0697, 0x19},
    {0x069B, 0x00},
    {0x069C, 0x30},  // max EDR ratio

    {0x0720, 0x00},
    {0x0725, 0x6A},
    {0x0726, 0x03},
    {0x072B, 0x64},
    {0x072C, 0x64},
    {0x072D, 0x20},
    //{0x072F, 0x01},
    {0x072E, 0x82},   //turn off night mode
    {0x072F, 0x08},

    {0x0800, 0x16},
    {0x0801, 0x30},
    {0x0802, 0x00},
    {0x0803, 0x68},
    {0x0804, 0x01},
    {0x0805, 0x28},
    {0x0806, 0x10},
    {0x0808, 0x1D},
    {0x0809, 0x18},
    {0x080A, 0x10},
    {0x080B, 0x07},
    {0x080D, 0x0F},
    {0x080E, 0x0F},
    {0x0810, 0x00},
    {0x0811, 0x08},
    {0x0812, 0x20},
    {0x0857, 0x0A},
    {0x0858, 0x30},
    {0x0859, 0x01},
    {0x085A, 0x03},	//(whole)Max INTG
    {0x085B, 0x40},
    {0x085C, 0x03},
    {0x085D, 0x7F},
    {0x085E, 0x02},	//(Long)Max INTG
    {0x085F, 0xD0},
    {0x0860, 0x03},
    {0x0861, 0x7F},
    {0x0862, 0x02},	//(short)Max INTG
    {0x0863, 0xD0},
    {0x0864, 0x00}, //(short)Max AG
    {0x0865, 0x7F},
    {0x0866, 0x01},
    {0x0867, 0x00},
    {0x0868, 0x40},
    {0x0869, 0x01},
    {0x086A, 0x00},
    {0x086B, 0x40},
    {0x086C, 0x01},
    {0x086D, 0x00},
    {0x086E, 0x40},
    {0x0870, 0x00},
    {0x0871, 0x14},
    {0x0872, 0x01},
    {0x0873, 0x20},
    {0x0874, 0x00},
    {0x0875, 0x14},
    {0x0876, 0x00},
    {0x0877, 0xEC},

    //----------------------------------------------
    //FLEXI ENGINE_GAMMA FOR MAXIMUM EDR
    //----------------------------------------------

    {0x0815, 0x00},
    {0x0816, 0x4C},
    {0x0817, 0x00},
    {0x0818, 0x7B},
    {0x0819, 0x00},
    {0x081A, 0xCA},
    {0x081B, 0x01},
    {0x081C, 0x3E},
    {0x081D, 0x01},
    {0x081E, 0x77},
    {0x081F, 0x01},
    {0x0820, 0xAA},
    {0x0821, 0x01},
    {0x0822, 0xCE},
    {0x0823, 0x01},
    {0x0824, 0xEE},
    {0x0825, 0x02},
    {0x0826, 0x16},
    {0x0827, 0x02},
    {0x0828, 0x33},
    {0x0829, 0x02},
    {0x082A, 0x65},
    {0x082B, 0x02},
    {0x082C, 0x91},
    {0x082D, 0x02},
    {0x082E, 0xDC},
    {0x082F, 0x03},
    {0x0830, 0x28},
    {0x0831, 0x03},
    {0x0832, 0x74},
    {0x0833, 0x03},
    {0x0834, 0xFF},

    //----------------------------------------------
    //FLEXI ENGINE_GAMMA FOR MINIMUM EDR
    //----------------------------------------------

    {0x0882, 0x00},
    {0x0883, 0x3E},
    {0x0884, 0x00},
    {0x0885, 0x70},
    {0x0886, 0x00},
    {0x0887, 0xB8},
    {0x0888, 0x01},
    {0x0889, 0x28},
    {0x088A, 0x01},
    {0x088B, 0x5B},
    {0x088C, 0x01},
    {0x088D, 0x8A},
    {0x088E, 0x01},
    {0x088F, 0xB1},
    {0x0890, 0x01},
    {0x0891, 0xD9},
    {0x0892, 0x01},
    {0x0893, 0xEE},
    {0x0894, 0x02},
    {0x0895, 0x0F},
    {0x0896, 0x02},
    {0x0897, 0x4C},
    {0x0898, 0x02},
    {0x0899, 0x74},
    {0x089A, 0x02},
    {0x089B, 0xC3},
    {0x089C, 0x03},
    {0x089D, 0x0F},
    {0x089E, 0x03},
    {0x089F, 0x57},
    {0x08A0, 0x03},
    {0x08A1, 0xFF},

    //----------------------------------------------
    //COMMAND UPDATE_TRIGGER
    //----------------------------------------------

    {0x0100, 0x01}, // CMU AE
    {0x0101, 0x01}, // CMU AWB
    {0x0000, 0x01}, // CMU
    {0x002C, 0x00}, // Reset 8051
    {0x0005, 0x01}, // Trigger
};

static CAP_TIMINFO_TABLE HM1375_TABLE [] = {
    //Index, HActive, VActive,  Rate,            FrameRate,                 Hpor,   Vpor,  HStar,     HEnd,   VStar1,   VEnd1,  VStar2,   VEnd2,
    {0,     1280,    720,     3000,   CAP_FRAMERATE_30HZ,       0,      0,      0,        0,        0,      0,   0,       0  }, //720p30 
    {0,      640,    480,     3000,   CAP_FRAMERATE_30HZ,       0,      0, 	  0,		0,		  0,	  0,   0,		0  }, 
    {0,      800,    600,     3000,   CAP_FRAMERATE_30HZ,       0,      0, 	  0, 		0,     	  0, 	  0,   0,    	0  }, 
    //{0,      800,    600,     3000,   CAP_FRAMERATE_30HZ,       0,      0,  /*80*/200, /*1600+80*/1600+200,     0, 599,   0,    599   }, 
};      

//=============================================================================
//                Private Function Definition
//=============================================================================
static uint16_t _HM1375_ReadI2c_Byte(uint16_t RegAddr)
{
    uint16_t    data;
    MMP_RESULT flag;
    uint8_t  dbuf[256];
    uint8_t*  pdbuf = dbuf;
    uint8_t value;

    *pdbuf++ = (uint8_t)((RegAddr&0xff00)>>8);
    *pdbuf++ = (uint8_t)(RegAddr&0x00ff);
          
    if (0 != (flag = mmpIicReceiveDataEx(IIC_PORT_0, IIC_MASTER_MODE, HM1375_IICADDR, dbuf, 2, pdbuf, 1)))
    {
        printf("HM1375 I2C Read error, reg = %02x\n", RegAddr);
        mmpIicGenStop(IIC_PORT_0);
    }

	value = (dbuf[2] & 0xFF);    
    return value;
}

static MMP_RESULT _HM1375_WriteI2c_Byte(uint16_t RegAddr, uint8_t data)
{
    MMP_RESULT flag;
    uint8_t   dbuf[256];
    uint8_t*  pdbuf = dbuf;
    
    *pdbuf++ = (uint8_t)((RegAddr&0xff00)>>8);
    *pdbuf++ = (uint8_t)(RegAddr&0x00ff);
    *pdbuf = (uint8_t)(data);
      
    if (0 != (flag = mmpIicSendDataEx(IIC_PORT_0, IIC_MASTER_MODE, HM1375_IICADDR, dbuf, 3)))
    {
        printf("HM1375 I2c write error, reg = %02x val =%02x\n", RegAddr, data);
        mmpIicGenStop(IIC_PORT_0);
    }
    return flag;
}

static void _HM1375Set640x480P30(void)
{
    uint16_t i;

    for (i = 0; i < (sizeof(RESOLUTION_640x480_REG) / sizeof(REGPAIR)); i++)
    {
        _HM1375_WriteI2c_Byte(RESOLUTION_640x480_REG[i].addr, RESOLUTION_640x480_REG[i].value);
    }
	
	HM1375_InWidth  = 640;
	HM1375_InHeight = 480;
	HM1375_InFrameRate = 3000;
}
static void _HM1375Set1280x720P30(void)
{
    uint16_t i;

    for (i = 0; i < (sizeof(RESOLUTION_1280x720p_REG) / sizeof(REGPAIR)); i++)
    {
        _HM1375_WriteI2c_Byte(RESOLUTION_1280x720p_REG[i].addr, RESOLUTION_1280x720p_REG[i].value);
    }
	
	HM1375_InWidth  = 1280;
	HM1375_InHeight = 720;
	HM1375_InFrameRate = 3000;
}

static void _HM1375Set800x600P30(void)
{
    uint16_t i;
    
    for (i = 0; i < (sizeof(RESOLUTION_800x600_REG) / sizeof(REGPAIR)); i++)
    {
        _HM1375_WriteI2c_Byte(RESOLUTION_800x600_REG[i].addr, RESOLUTION_800x600_REG[i].value);
    }

	HM1375_InWidth  = 800;
	HM1375_InHeight = 600;
	HM1375_InFrameRate = 3000;
}

static MMP_BOOL _HM1375_ReadSensorID(void)
{
	uint32_t SenSorID; 
    SenSorID =	(_HM1375_ReadI2c_Byte(0x0001) << 8 | _HM1375_ReadI2c_Byte(0x0002));

	return MMP_TRUE;
}

//=============================================================================
//                Public Function Definition
//=============================================================================
void HM1375Initialize(void)
{
	MMP_BOOL    bSensorID;	
    uint16_t data;
    printf("HM1375 Initial\n");

    gHM1375InitDone = MMP_FALSE;
	
    usleep(1000* 10);
		
	#if defined (CFG_CAPTURE_MODULE_RESOLUTION_1280x720) || defined (CFG_SECOND_CAPTURE_MODULE_RESOLUTION_1280x720)
        printf("setting resulution 720p!\n");
        _HM1375Set1280x720P30();
	#endif
	#if defined(CFG_CAPTURE_MODULE_RESOLUTION_800x600) || defined (CFG_SECOND_CAPTURE_MODULE_RESOLUTION_800x600)
        printf("setting resulution 800x600!\n");
        _HM1375Set800x600P30();
	#endif
	#if defined(CFG_CAPTURE_MODULE_RESOLUTION_640x480) || defined (CFG_SECOND_CAPTURE_MODULE_RESOLUTION_640x480)
        printf("setting resulution 640x480!\n");
        _HM1375Set640x480P30();
	#endif	

    gHM1375InitDone = MMP_TRUE;
}

void HM1375Terminate(void)
{
    printf("HM1375Terminate\n");
}

void HM1375OutputPinTriState(unsigned char flag)
{
}

unsigned char HM1375IsSignalStable(void)
{
	return true;
}

void HM1375GetProperty(CAP_GET_PROPERTY * pGetProperty)
{
    uint16_t i;
    pGetProperty->GetTopFieldPolarity = MMP_FALSE;
    pGetProperty->GetHeight = HM1375_InHeight;
    pGetProperty->GetWidth  = HM1375_InWidth;
    pGetProperty->Rate = HM1375_InFrameRate;
    pGetProperty->GetModuleIsInterlace = 0;

    for (i = 0; i < (sizeof(HM1375_TABLE) / sizeof(CAP_TIMINFO_TABLE)); ++i)
    {
       if ((pGetProperty->GetWidth == HM1375_TABLE[i].HActive) && (pGetProperty->GetHeight == HM1375_TABLE[i].VActive) && pGetProperty->Rate == HM1375_TABLE[i].Rate)
        {
            pGetProperty->HPolarity       = HM1375_TABLE[i].HPolarity; 
            pGetProperty->VPolarity       = HM1375_TABLE[i].VPolarity;
            pGetProperty->FrameRate       = HM1375_TABLE[i].FrameRate; 
            pGetProperty->matchResolution = MMP_TRUE;

            pGetProperty->HStar  = HM1375_TABLE[i].HStar;
            pGetProperty->HEnd   = HM1375_TABLE[i].HEnd;
            pGetProperty->VStar1 = HM1375_TABLE[i].VStar1;
            pGetProperty->VEnd1  = HM1375_TABLE[i].VEnd1;
            pGetProperty->VStar2 = HM1375_TABLE[i].VStar2; 
            pGetProperty->VEnd2  = HM1375_TABLE[i].VEnd2; 
        }
    }
}

void HM1375PowerDown(unsigned char enable)
{
}

void HM1375ForCaptureDriverSetting(CAP_CONTEXT *Capctxt )
{
    /* Input Format default Setting */
    Capctxt->Interleave   = Progressive;

    /* Input Data Format Setting */
    // 8bit bus
    Capctxt->YUV422Format  = CAP_IN_YUV422_YUYV;
    Capctxt->EnDEMode             = MMP_TRUE;
    Capctxt->input_protocol       = BT_601;
    
    Capctxt->input_video_source.HSYNCDE =   MMP_TRUE;
}

static void HM1375CaptureModuleDriver_Destory(CaptureModuleDriver base)
{
    HM1375CaptureModuleDriver self = (HM1375CaptureModuleDriver)base;
    if(self)
        free(self);
}

static CaptureModuleDriverInterfaceStruct interface =
{
    HM1375Initialize,
    HM1375Terminate,
    HM1375OutputPinTriState,
    HM1375IsSignalStable,
    HM1375GetProperty,
    HM1375PowerDown,
    HM1375ForCaptureDriverSetting,
    HM1375CaptureModuleDriver_Destory
};

CaptureModuleDriver HM1375CaptureModuleDriver_Create()
{
    HM1375CaptureModuleDriver self = calloc(1, sizeof(HM1375CaptureModuleDriverStruct));
    self->base.vtable = &interface;
    self->base.type = "HM1375";
    return (HM1375CaptureModuleDriver)self;
}
